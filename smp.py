# -*- coding: utf-8 -*-
"""SMP.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1gbwBdUrRDESL7GtTtGII9Y5MwskMhQue
"""

# =========================
# Student Marks Prediction Project
# Linear Regression vs Decision Tree
# Real Dataset + Constraints + Visualization
# =========================

# 1. Import Libraries
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.tree import DecisionTreeRegressor
from sklearn.metrics import mean_absolute_error, mean_squared_error
import matplotlib.pyplot as plt

# =========================
# 2. Load Dataset
# =========================
data = pd.read_csv("/content/Student_Marks.csv")

# =========================
# 3. Feature Selection
# =========================
X = data[["number_courses", "time_study"]]   # Input features
y = data["Marks"]                            # Target variable

# =========================
# 4. Train–Test Split
# =========================
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# =========================
# 5. Train Models
# =========================
lr_model = LinearRegression()
lr_model.fit(X_train, y_train)

dt_model = DecisionTreeRegressor(random_state=42)
dt_model.fit(X_train, y_train)

# =========================
# 6. Predictions
# =========================
lr_predictions = lr_model.predict(X_test)
dt_predictions = dt_model.predict(X_test)

# =========================
# 7. Apply Realistic Constraints
# =========================
lr_predictions = np.clip(lr_predictions, 0, 100)
dt_predictions = np.clip(dt_predictions, 0, 100)

# =========================
# 8. Evaluation Metrics
# =========================
print("Linear Regression Results")
print("MAE:", mean_absolute_error(y_test, lr_predictions))
print("MSE:", mean_squared_error(y_test, lr_predictions))
print("-" * 30)

print("Decision Tree Results")
print("MAE:", mean_absolute_error(y_test, dt_predictions))
print("MSE:", mean_squared_error(y_test, dt_predictions))
print("-" * 30)

# =========================
# 9. Visualization
# =========================
# Actual vs Predicted (Linear Regression)
plt.scatter(y_test, lr_predictions)
plt.xlabel("Actual Marks")
plt.ylabel("Predicted Marks")
plt.title("Actual vs Predicted Marks (Linear Regression)")
plt.plot(
    [y_test.min(), y_test.max()],
    [y_test.min(), y_test.max()],
    color="red"
)
plt.show()

# Error comparison
models = ["Linear Regression", "Decision Tree"]
mae_values = [
    mean_absolute_error(y_test, lr_predictions),
    mean_absolute_error(y_test, dt_predictions)
]

plt.bar(models, mae_values)
plt.ylabel("Mean Absolute Error")
plt.title("Model Comparison")
plt.show()

# =========================
# 10. User Input Prediction
# =========================
num_courses = float(input("Enter number of courses (1–10): "))
time_study = float(input("Enter study time in hours (0–12): "))

# Apply input constraints
num_courses = np.clip(num_courses, 1, 10)
time_study = np.clip(time_study, 0, 12)

# Prepare input
new_data = pd.DataFrame(
    [[num_courses, time_study]],
    columns=["number_courses", "time_study"]
)

# Predict
predicted_marks = lr_model.predict(new_data)
predicted_marks = np.clip(predicted_marks, 0, 100)

print("Predicted Marks (0–100):", round(predicted_marks[0], 2))